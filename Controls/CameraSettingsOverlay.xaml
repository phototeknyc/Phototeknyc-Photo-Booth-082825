<UserControl x:Class="Photobooth.Controls.CameraSettingsOverlay"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Photobooth.Controls"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="400">
    
    <UserControl.Resources>
        <!-- Modern Toggle Button Style -->
        <Style x:Key="ModernToggleButton" TargetType="RadioButton">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="border" 
                                Background="#3A3A3A" 
                                BorderBrush="#555"
                                BorderThickness="1"
                                CornerRadius="8"
                                Padding="12,8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#2196F3"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#2196F3"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#4A4A4A"/>
                                <Setter TargetName="border" Property="Cursor" Value="Hand"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Margin" Value="4"/>
        </Style>
        
        <!-- Modern Slider Style -->
        <Style x:Key="ModernSlider" TargetType="Slider">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Slider">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto" MinHeight="{TemplateBinding MinHeight}"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Border x:Name="TrackBackground" 
                                    Grid.Row="1" 
                                    Background="#3A3A3A" 
                                    Height="4" 
                                    CornerRadius="2" 
                                    VerticalAlignment="Center">
                                <Canvas>
                                    <Rectangle x:Name="PART_SelectionRange" 
                                               Fill="#2196F3" 
                                               Height="4" 
                                               RadiusX="2" 
                                               RadiusY="2"/>
                                </Canvas>
                            </Border>
                            <Track Grid.Row="1" x:Name="PART_Track">
                                <Track.Thumb>
                                    <Thumb>
                                        <Thumb.Template>
                                            <ControlTemplate TargetType="Thumb">
                                                <Ellipse Width="20" Height="20" Fill="#2196F3" Stroke="#1976D2" StrokeThickness="2"/>
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Fade In Animation -->
        <Storyboard x:Key="FadeIn">
            <DoubleAnimation Storyboard.TargetProperty="Opacity" 
                             From="0" To="1" Duration="0:0:0.3"/>
        </Storyboard>
        
        <!-- Slide In Animation -->
        <Storyboard x:Key="SlideIn">
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)" 
                             From="50" To="0" Duration="0:0:0.4">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
    </UserControl.Resources>
    
    <!-- Overlay Background with Blur Effect -->
    <Grid x:Name="OverlayGrid" Background="#E6000000">
        <Grid.Triggers>
            <EventTrigger RoutedEvent="Loaded">
                <BeginStoryboard Storyboard="{StaticResource FadeIn}"/>
            </EventTrigger>
        </Grid.Triggers>
        
        <!-- Settings Panel -->
        <Border x:Name="SettingsPanel"
                Background="#2D2D30" 
                CornerRadius="20" 
                MaxWidth="1200" MaxHeight="800"
                Width="1200" Height="800"
                Margin="40">
            <Border.RenderTransform>
                <TranslateTransform/>
            </Border.RenderTransform>
            <Border.Triggers>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard Storyboard="{StaticResource SlideIn}"/>
                </EventTrigger>
            </Border.Triggers>
            <Border.Effect>
                <DropShadowEffect Color="Black" BlurRadius="30" ShadowDepth="0" Opacity="0.5"/>
            </Border.Effect>
            
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Modern Header -->
                <Border Grid.Row="0" Background="#1F1F1F" CornerRadius="20,20,0,0">
                    <Grid Margin="24,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <!-- Camera Icon -->
                            <Border Background="#2196F3" CornerRadius="10" Width="40" Height="40" Margin="0,0,16,0">
                                <Path Width="22" Height="22" Stretch="Uniform" Fill="White" HorizontalAlignment="Center" VerticalAlignment="Center"
                                      Data="M12 2L4 7V18H20V7L12 2M12 17.5C9.51 17.5 7.5 15.49 7.5 13S9.51 8.5 12 8.5 16.5 10.51 16.5 13 14.49 17.5 12 17.5M12 10.5C10.62 10.5 9.5 11.62 9.5 13S10.62 15.5 12 15.5 14.5 14.38 14.5 13 13.38 10.5 12 10.5"/>
                            </Border>
                            
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="CAMERA SETTINGS" FontSize="18" FontWeight="Bold" 
                                           Foreground="White"/>
                                <TextBlock Text="Professional Controls" FontSize="11" 
                                           Foreground="#888" Margin="0,2,0,0"/>
                            </StackPanel>
                        </StackPanel>
                        
                        <!-- Modern Close Button -->
                        <Button Grid.Column="1" x:Name="CloseButton" 
                                Background="#3A3A3A" BorderThickness="0" 
                                Width="54" Height="54" 
                                Click="CloseButton_Click">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="8">
                                                    <Path Width="20" Height="20" Stretch="Uniform" 
                                                          Fill="#AAA" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                          Data="M 0,0 L 10,10 M 0,10 L 10,0" 
                                                          StrokeThickness="2.5" Stroke="#AAA"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter TargetName="border" Property="Background" Value="#4A4A4A"/>
                                                        <Setter Property="Cursor" Value="Hand"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </Button.Style>
                        </Button>
                    </Grid>
                </Border>
                
                <!-- Settings Content with Preview -->
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="500"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Settings Panel (Left) -->
                    <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto" 
                                  HorizontalScrollBarVisibility="Disabled"
                                  Margin="24,24,12,24">
                        <ScrollViewer.Resources>
                            <Style TargetType="ScrollBar">
                                <Setter Property="Width" Value="8"/>
                                <Setter Property="Background" Value="#1A1A1A"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ScrollBar">
                                            <Grid>
                                                <Border Background="#1A1A1A" CornerRadius="4"/>
                                                <Track x:Name="PART_Track" IsDirectionReversed="True">
                                                    <Track.Thumb>
                                                        <Thumb>
                                                            <Thumb.Template>
                                                                <ControlTemplate TargetType="Thumb">
                                                                    <Border Background="#4A4A4A" CornerRadius="4">
                                                                        <Border.Style>
                                                                            <Style TargetType="Border">
                                                                                <Style.Triggers>
                                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                                        <Setter Property="Background" Value="#5A5A5A"/>
                                                                                    </Trigger>
                                                                                </Style.Triggers>
                                                                            </Style>
                                                                        </Border.Style>
                                                                    </Border>
                                                                </ControlTemplate>
                                                            </Thumb.Template>
                                                        </Thumb>
                                                    </Track.Thumb>
                                                </Track>
                                            </Grid>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ScrollViewer.Resources>
                        <StackPanel Margin="0,10,20,0">
                        
                        <!-- Camera Selection -->
                        <StackPanel Margin="0,0,0,20">
                            <TextBlock Text="Camera" FontSize="14" Foreground="#999" Margin="0,0,0,8"/>
                            <ComboBox x:Name="CameraComboBox" FontSize="15" Height="42" 
                                      Background="{StaticResource SurfacePanelBrush}" 
                                      Foreground="White" BorderBrush="{StaticResource SurfaceBorderBrush}"
                                      SelectionChanged="CameraComboBox_SelectionChanged"/>
                        </StackPanel>
                        
                        <!-- Image Quality - IMPORTANT: Default to JPEG -->
                        <StackPanel Margin="0,0,0,20">
                            <TextBlock Text="Image Quality" FontSize="14" Foreground="#999" Margin="0,0,0,8"/>
                            <ComboBox x:Name="ImageQualityComboBox" FontSize="15" Height="42"
                                      Background="{StaticResource SurfacePanelBrush}" 
                                      Foreground="White" BorderBrush="{StaticResource SurfaceBorderBrush}"
                                      SelectionChanged="ImageQualityComboBox_SelectionChanged">
                                <ComboBoxItem Content="JPEG Fine" IsSelected="True"/>
                                <ComboBoxItem Content="JPEG Normal"/>
                                <ComboBoxItem Content="JPEG Basic"/>
                                <ComboBoxItem Content="RAW"/>
                                <ComboBoxItem Content="RAW + JPEG Fine"/>
                            </ComboBox>
                        </StackPanel>
                        
                        <!-- ISO Setting -->
                        <StackPanel Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="ISO" FontSize="14" Foreground="#999"/>
                                <TextBlock Grid.Column="1" x:Name="ISOValueText" Text="Auto" 
                                           FontSize="14" Foreground="#0078D4"/>
                            </Grid>
                            <ComboBox x:Name="ISOComboBox" FontSize="15" Height="42" Margin="0,8,0,0"
                                      Background="{StaticResource SurfacePanelBrush}" 
                                      Foreground="White" BorderBrush="{StaticResource SurfaceBorderBrush}"
                                      SelectionChanged="ISOComboBox_SelectionChanged">
                                <ComboBoxItem Content="Auto" IsSelected="True"/>
                                <ComboBoxItem Content="100"/>
                                <ComboBoxItem Content="200"/>
                                <ComboBoxItem Content="400"/>
                                <ComboBoxItem Content="800"/>
                                <ComboBoxItem Content="1600"/>
                                <ComboBoxItem Content="3200"/>
                                <ComboBoxItem Content="6400"/>
                            </ComboBox>
                        </StackPanel>
                        
                        <!-- Aperture (F-Stop) Setting -->
                        <StackPanel Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Aperture (F-Stop)" FontSize="14" Foreground="#999"/>
                                <TextBlock Grid.Column="1" x:Name="ApertureValueText" Text="Auto" 
                                           FontSize="14" Foreground="#0078D4"/>
                            </Grid>
                            <ComboBox x:Name="ApertureComboBox" FontSize="15" Height="42" Margin="0,8,0,0"
                                      Background="{StaticResource SurfacePanelBrush}" 
                                      Foreground="White" BorderBrush="{StaticResource SurfaceBorderBrush}"
                                      SelectionChanged="ApertureComboBox_SelectionChanged">
                                <ComboBoxItem Content="Auto" IsSelected="True"/>
                                <ComboBoxItem Content="f/1.4"/>
                                <ComboBoxItem Content="f/1.8"/>
                                <ComboBoxItem Content="f/2.0"/>
                                <ComboBoxItem Content="f/2.8"/>
                                <ComboBoxItem Content="f/4.0"/>
                                <ComboBoxItem Content="f/5.6"/>
                                <ComboBoxItem Content="f/8.0"/>
                                <ComboBoxItem Content="f/11"/>
                                <ComboBoxItem Content="f/16"/>
                            </ComboBox>
                        </StackPanel>
                        
                        <!-- Shutter Speed Setting -->
                        <StackPanel Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Shutter Speed" FontSize="14" Foreground="#999"/>
                                <TextBlock Grid.Column="1" x:Name="ShutterSpeedValueText" Text="Auto" 
                                           FontSize="14" Foreground="#0078D4"/>
                            </Grid>
                            <ComboBox x:Name="ShutterSpeedComboBox" FontSize="15" Height="42" Margin="0,8,0,0"
                                      Background="{StaticResource SurfacePanelBrush}" 
                                      Foreground="White" BorderBrush="{StaticResource SurfaceBorderBrush}"
                                      SelectionChanged="ShutterSpeedComboBox_SelectionChanged">
                                <ComboBoxItem Content="Auto" IsSelected="True"/>
                                <ComboBoxItem Content="1/2000"/>
                                <ComboBoxItem Content="1/1000"/>
                                <ComboBoxItem Content="1/500"/>
                                <ComboBoxItem Content="1/250"/>
                                <ComboBoxItem Content="1/125"/>
                                <ComboBoxItem Content="1/60"/>
                                <ComboBoxItem Content="1/30"/>
                                <ComboBoxItem Content="1/15"/>
                            </ComboBox>
                        </StackPanel>
                        
                        <!-- White Balance Setting -->
                        <StackPanel Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="White Balance" FontSize="14" Foreground="#999"/>
                                <TextBlock Grid.Column="1" x:Name="WhiteBalanceValueText" Text="Auto" 
                                           FontSize="14" Foreground="#0078D4"/>
                            </Grid>
                            <ComboBox x:Name="WhiteBalanceComboBox" FontSize="15" Height="42" Margin="0,8,0,0"
                                      Background="{StaticResource SurfacePanelBrush}" 
                                      Foreground="White" BorderBrush="{StaticResource SurfaceBorderBrush}"
                                      SelectionChanged="WhiteBalanceComboBox_SelectionChanged">
                                <ComboBoxItem Content="Auto" IsSelected="True"/>
                                <ComboBoxItem Content="Daylight"/>
                                <ComboBoxItem Content="Cloudy"/>
                                <ComboBoxItem Content="Tungsten"/>
                                <ComboBoxItem Content="Fluorescent"/>
                                <ComboBoxItem Content="Flash"/>
                            </ComboBox>
                        </StackPanel>
                        
                        <!-- Exposure Compensation -->
                        <StackPanel Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Exposure Compensation" FontSize="14" Foreground="#999"/>
                                <TextBlock Grid.Column="1" x:Name="ExposureCompValueText" Text="0 EV" 
                                           FontSize="14" Foreground="#0078D4"/>
                            </Grid>
                            <Slider x:Name="ExposureCompSlider" 
                                    Minimum="-3" Maximum="3" Value="0" 
                                    TickFrequency="0.5" IsSnapToTickEnabled="True"
                                    Margin="0,8,0,0"
                                    ValueChanged="ExposureCompSlider_ValueChanged"/>
                            <Grid Margin="0,4,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="-3 EV" FontSize="12" Foreground="#666" HorizontalAlignment="Left"/>
                                <TextBlock Grid.Column="1" Text="0" FontSize="12" Foreground="#666" HorizontalAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="+3 EV" FontSize="12" Foreground="#666" HorizontalAlignment="Right"/>
                            </Grid>
                        </StackPanel>
                        
                        </StackPanel>
                    </ScrollViewer>
                    
                    <!-- Separator -->
                    <Border Grid.Column="1" Width="1" Background="#3A3A3A" Margin="0,24"/>
                    
                    <!-- Preview Panel (Right) -->
                    <Grid Grid.Column="2" Margin="12,24,24,24">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <!-- Preview Header -->
                        <TextBlock Grid.Row="0" Text="TEST PREVIEW" FontSize="14" FontWeight="SemiBold"
                                   Foreground="#999" Margin="0,0,0,16"/>
                        
                        <!-- Image Preview Area -->
                        <Border Grid.Row="1" Background="#1A1A1A" CornerRadius="8" 
                                BorderBrush="#3A3A3A" BorderThickness="1"
                                MinHeight="400">
                            <Grid>
                                <!-- Live View Display -->
                                <Image x:Name="LiveViewImage" 
                                       Stretch="Uniform" 
                                       Visibility="Visible"
                                       RenderOptions.BitmapScalingMode="LowQuality"/>
                                
                                <!-- Placeholder when no live view -->
                                <StackPanel x:Name="PreviewPlaceholder" 
                                            VerticalAlignment="Center" HorizontalAlignment="Center"
                                            Visibility="Collapsed">
                                    <Path Data="M12 2L4 7V18H20V7L12 2M12 17.5C9.51 17.5 7.5 15.49 7.5 13S9.51 8.5 12 8.5 16.5 10.51 16.5 13 14.49 17.5 12 17.5M12 10.5C10.62 10.5 9.5 11.62 9.5 13S10.62 15.5 12 15.5 14.5 14.38 14.5 13 13.38 10.5 12 10.5"
                                          Width="48" Height="48" Stretch="Uniform" 
                                          Fill="#4A4A4A" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Live view not available" FontSize="13" 
                                               Foreground="#666" Margin="0,12,0,0"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                                
                                <!-- Test Image Display (overlays live view when captured) -->
                                <Image x:Name="TestImagePreview" 
                                       Stretch="Uniform" 
                                       Visibility="Collapsed"
                                       RenderOptions.BitmapScalingMode="HighQuality"/>
                                
                                <!-- Live View Status -->
                                <Border x:Name="LiveViewStatus" 
                                        Background="#CC000000" 
                                        CornerRadius="4" 
                                        Padding="8,4"
                                        HorizontalAlignment="Left" 
                                        VerticalAlignment="Top" 
                                        Margin="8"
                                        Visibility="Visible">
                                    <StackPanel Orientation="Horizontal">
                                        <Ellipse Width="8" Height="8" Fill="#4CAF50" Margin="0,0,6,0">
                                            <Ellipse.Triggers>
                                                <EventTrigger RoutedEvent="Loaded">
                                                    <BeginStoryboard>
                                                        <Storyboard RepeatBehavior="Forever">
                                                            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                                             From="0.3" To="1" Duration="0:0:1"
                                                                             AutoReverse="True"/>
                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </EventTrigger>
                                            </Ellipse.Triggers>
                                        </Ellipse>
                                        <TextBlock Text="LIVE" FontSize="11" Foreground="White" FontWeight="SemiBold"/>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </Border>
                        
                        <!-- Test Button (Centered) -->
                        <Grid Grid.Row="2" Margin="0,20,0,0">
                            <!-- Take Test Picture Button (Centered) -->
                            <Button x:Name="LargeTestPictureButton" 
                                    Height="60"
                                    Width="280"
                                    HorizontalAlignment="Center"
                                    Background="#4CAF50" 
                                    Foreground="White" BorderThickness="0"
                                    Click="TestPictureButton_Click" Cursor="Hand">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock Text="📷" FontSize="24" Margin="0,0,12,0" VerticalAlignment="Center"/>
                                    <TextBlock Text="TAKE TEST PICTURE" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                </StackPanel>
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}" 
                                                        CornerRadius="8" 
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        BorderBrush="{TemplateBinding BorderBrush}">
                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="#5CBF60"/>
                                                    </Trigger>
                                                    <Trigger Property="IsPressed" Value="True">
                                                        <Setter Property="Background" Value="#45A049"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </Button.Style>
                        </Button>
                    </Grid>
                    </Grid>
                </Grid>
                
                <!-- Footer Actions -->
                <Border Grid.Row="2" Background="{StaticResource SurfacePanelBrush}" 
                        CornerRadius="0,0,8,8" Padding="20,16">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Reset to Defaults -->
                        <Button Grid.Column="0" x:Name="ResetButton" 
                                Content="Reset to Defaults" 
                                FontSize="14" Padding="12,8" Margin="0,0,8,0"
                                Background="{StaticResource SurfaceButtonHoverBrush}" 
                                Foreground="White" BorderThickness="0"
                                HorizontalAlignment="Left"
                                Click="ResetButton_Click" Cursor="Hand">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}" 
                                                        CornerRadius="4" 
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        BorderBrush="{TemplateBinding BorderBrush}">
                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="{StaticResource SurfaceButtonPressedBrush}"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </Button.Style>
                        </Button>
                        
                        <!-- Auto-Save Status Indicator -->
                        <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Path Data="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" 
                                  Fill="#4CAF50" Width="16" Height="16" Stretch="Uniform" Margin="0,0,8,0">
                                <Path.Triggers>
                                    <EventTrigger RoutedEvent="Loaded">
                                        <BeginStoryboard>
                                            <Storyboard RepeatBehavior="Forever">
                                                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                                 From="0.4" To="1" Duration="0:0:1.5"
                                                                 AutoReverse="True"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Path.Triggers>
                            </Path>
                            <TextBlock Text="Auto-Save Enabled" FontSize="13" Foreground="#B0B0B0" VerticalAlignment="Center"/>
                        </StackPanel>
                        
                        <!-- Close Button (was Cancel) -->
                        <Button Grid.Column="2" x:Name="CancelButton" 
                                Content="CLOSE" 
                                FontSize="16" FontWeight="SemiBold"
                                Width="120" Height="50"
                                Background="#0078D4" 
                                Foreground="White" BorderThickness="0"
                                Click="CancelButton_Click" Cursor="Hand">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}" 
                                                        CornerRadius="4" 
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        BorderBrush="{TemplateBinding BorderBrush}">
                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="#106EBE"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </Button.Style>
                        </Button>
                    </Grid>
                </Border>
            </Grid>
        </Border>
    </Grid>
</UserControl>